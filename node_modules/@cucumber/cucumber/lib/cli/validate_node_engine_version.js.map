{"version":3,"file":"validate_node_engine_version.js","sourceRoot":"","sources":["../../src/cli/validate_node_engine_version.ts"],"names":[],"mappings":";;;;;;AAAA,4CAAmB;AACnB,gDAAuB;AACvB,oDAA2B;AAO3B,MAAM,qBAAqB,GAAsB,GAAG,EAAE,CACpD,IAAI,CAAC,KAAK,CACR,YAAE;KACC,YAAY,CAAC,cAAI,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,cAAc,CAAC,CAAC;KACjE,QAAQ,EAAE,CACd,CAAA;AAEH,SAAgB,yBAAyB,CACvC,cAAsB,EACtB,OAAkC,EAClC,SAAoC,EACpC,kBAAqC,qBAAqB;IAE1D,MAAM,gBAAgB,GAAG,eAAe,EAAE,CAAC,OAAO,CAAC,IAAI,CAAA;IACvD,MAAM,cAAc,GAAG,eAAe,EAAE,CAAC,aAAa,CAAC,IAAI,CAAA;IAC3D,IAAI,CAAC,gBAAM,CAAC,SAAS,CAAC,cAAc,EAAE,gBAAgB,CAAC,EAAE;QACvD,OAAO,CACL,6CAA6C,gBAAgB,6BAA6B,cAAc,EAAE,CAC3G,CAAA;KACF;SAAM,IAAI,CAAC,gBAAM,CAAC,SAAS,CAAC,cAAc,EAAE,cAAc,CAAC,EAAE;QAC5D,SAAS,CACP,yBAAyB,cAAc,yIAAyI,CACjL,CAAA;KACF;AACH,CAAC;AAjBD,8DAiBC","sourcesContent":["import fs from 'fs'\nimport path from 'path'\nimport semver from 'semver'\n\ntype PackageJSON = {\n  engines: { node: string }\n  enginesTested: { node: string }\n}\n\nconst readActualPackageJSON: () => PackageJSON = () =>\n  JSON.parse(\n    fs\n      .readFileSync(path.resolve(__dirname, '..', '..', 'package.json'))\n      .toString()\n  )\n\nexport function validateNodeEngineVersion(\n  currentVersion: string,\n  onError: (message: string) => void,\n  onWarning: (message: string) => void,\n  readPackageJSON: () => PackageJSON = readActualPackageJSON\n): void {\n  const requiredVersions = readPackageJSON().engines.node\n  const testedVersions = readPackageJSON().enginesTested.node\n  if (!semver.satisfies(currentVersion, requiredVersions)) {\n    onError(\n      `Cucumber can only run on Node.js versions ${requiredVersions}. This Node.js version is ${currentVersion}`\n    )\n  } else if (!semver.satisfies(currentVersion, testedVersions)) {\n    onWarning(\n      `This Node.js version (${currentVersion}) has not been tested with this version of Cucumber; it should work normally, but please raise an issue if you see anything unexpected.`\n    )\n  }\n}\n"]}